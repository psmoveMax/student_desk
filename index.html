<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" href="style.css">
  <title>Список студентов</title>
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"
    integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>
  <script src="main.js"></script>

</head>
<header>
  <h1 style="text-align:center;">Список студентов</h1>
</header>

<body>
  <div class="container">
    <button type="submit" id="btn_add" class="btn btn-primary">Добавить студента</button>
    <div class="wrap">
      <form id="main_add_form" name="form">
        <div class="form-group">
          <label for="fio">ФИО</label>
          <input type="text" class="form-control" id="fio" name="fio" required>
        </div>
        <div class="form-group">
          <label for="fakultet">Факультет</label>
          <input type="text" class="form-control" id="fakultet" name="fakultet" required>
        </div>
        <div class="form-group">
          <label class="form-check-label" for="date_birth">Дата рождения</label>
          <input type="date" class="form-control" id="date_birth" name="date_birth" required>
        </div>
        <div class="form-group">
          <label class="form-check-label" for="date_learn">Год начала обучения</label>
          <input type="text" class="form-control" id="date_learn" name="date_learn" required>
        </div>
        <button type="submit" class="btn btn-primary" id="btn_save">Сохранить</button>
        <button type="button" id="btn_form_close" class="btn btn-warning">Закрыть</button>
      </form>
    </div>
    <h5>Фильтрация</h5>
    <form id="form_filter">
      <input type="text" class="form-control fa" id="search_fio" onkeyup="search_func()"
        placeholder="Введите ФИО &#128269" aria-describedby="basic-addon1">
      <input type="text" class="form-control fa" id="search_fakultet" onkeyup="search_func()"
        placeholder="Введите факультет &#128269" aria-describedby="basic-addon1">
      <input type="number" class="form-control fa " id="search_year_start" onkeyup="search_func()"
        placeholder="Год начала обучения &#128269" aria-describedby="basic-addon1">
      <input type="number" class="form-control fa" id="search_year_end" onkeyup="search_func()"
        placeholder=" Год окончания обучения &#128269" aria-describedby="basic-addon1">
    </form>
    <hr>
    <table class="table  table-bordered" id="table_main">
      <thead>
        <tr>
          <th scope="col" id="sort_fio">ФИО <i id="sort_fio_activity"
              style="font-size: 15px;font-style: normal;">&#5121;</i></th>
          <th scope="col" id="sort_fak">Факультет <i id="sort_fak_activity"
              style="font-size: 15px;font-style: normal;">&#5121;</i></th>
          <th scope="col" id="sort_birth">Дата рождения <i class="fas fa-chevron-down fa_sort"></i></th>
          <th scope="col" id="sort_learn">Годы обучения <i class="fas fa-chevron-down fa_sort"></i></th>
        </tr>
      </thead>
      <tbody id="table_data">
        <tr>
        </tr>
      </tbody>
    </table>

  </div>


  <script>


    function search_func() {
      let fio_input, fak_input, start_input, filter, table, tr, td, i;
      fio_input = document.getElementById("search_fio");
      filter_fio = fio_input.value.toUpperCase();

      fak_input = document.getElementById("search_fakultet");
      filter_fak = fak_input.value.toUpperCase();


      start_input = document.getElementById("search_year_start");
      filter_start = start_input.value;

      end_input = document.getElementById("search_year_end");
      filter_end = end_input.value;
      const regular = /(\d{4})/gm;

      table = document.getElementById("table_main");
      tr = table.getElementsByTagName("tr");
      for (i = 1; i < tr.length; i++) {
        th_fio = tr[i].getElementsByTagName("th")[0];
        td_fak = tr[i].getElementsByTagName("td")[0];
        td_learn = tr[i].getElementsByTagName("td")[2];



        if (th_fio && td_fak && td_learn) {
          if (td_fak.innerHTML.toUpperCase().indexOf(filter_fak) > -1 &&
            th_fio.innerHTML.toUpperCase().indexOf(filter_fio) > -1) {
            if (filter_start == '' && filter_end == '') {
              tr[i].style.display = "";
            } else {
              if (td_learn.innerHTML.match(regular)) {
                if (filter_start != '' && filter_end != '') {
                  if (filter_start == td_learn.innerHTML.match(regular)[0] &&
                    filter_end == td_learn.innerHTML.match(regular)[1]) {
                    tr[i].style.display = "";
                  } else {
                    tr[i].style.display = "none";
                  }
                } else {
                  if (filter_start == td_learn.innerHTML.match(regular)[0] ||
                    filter_end == td_learn.innerHTML.match(regular)[1]) {
                    tr[i].style.display = "";
                  } else {
                    tr[i].style.display = "none";
                  }
                }
              } else {
                tr[i].style.display = "none";
              }
            }
          } else {
            tr[i].style.display = "none";
          }
        }
      }

    }



  </script>
</body>
<!--
<footer class="footer">
  0.5<a target="_blank" href="https://github.com/psmoveMax/student_desk">GitHub</a>
</footer> -->

</html>